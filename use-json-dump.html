<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Tutorial: Hello Dojo!</title>
  </head>
  <body>
    <!-- load Dojo -->
    <!-- https://dojotoolkit.org/download/ -->
    <!-- http://jsfiddle.net/user/fiddles/all/ -->
    <!-- https://dojotoolkit.org/reference-guide/1.7/dojox/json/ref.html -->
    <script src="//ajax.googleapis.com/ajax/libs/dojo/1.14.1/dojo/dojo.js" data-dojo-config="async: true"></script>

    <script>
      let y = {
        foo: { baz: 4 },
        quux: 5,
        array: [
          {
            does: 'work',
            too: [4, 5, 6],
          },
          {
            really: 'yes',
          },
        ],
      }
      let ME = {
        name: 'Kris',
        father: { name: 'Bill' },
        mother: { name: 'Karen' },
      }
      require(['dojox/json/ref'], function () {
        let me = {
          name: 'Kris',
          father: { name: 'Bill' },
          mother: { name: 'Karen' },
        }
        let jsonMe = dojox.json.ref.toJson(me) // serialize me
        console.log(jsonMe)
        let jsonWindow = dojox.json.ref.toJson(window) // serialize me
        console.log(jsonWindow) // 出力できる
        let objectWindow = dojox.json.ref.fromJson(jsonWindow)
        console.log(objectWindow) // 出力できる
        let jsonReflect = dojox.json.ref.toJson(Reflect) // serialize me
        console.log(jsonReflect) // 出力できる
        let objectReflect = dojox.json.ref.fromJson(jsonReflect)
        console.log(objectReflect) // 出力できる
      })
      console.log(JSON.stringify(ME))
      console.log(JSON.stringify(y))
      console.log(window)
      console.log(JSON.stringify(window))
      //   use-json-dump.html:48 Uncaught TypeError: Converting circular structure to JSON
      // --> starting at object with constructor 'Window'
      // --- property 'window' closes the circle
      // at JSON.stringify (<anonymous>)
    </script>
  </body>
</html>
